<div class="product" [ngClass]="{'selectable': hasMetricReports()}" *ngIf="isOutsideNavigationValid() == 1">
	<div class="product-heading" fxLayout="row">
		<span class="name" fxFlex>{{buildingBlock.name}}</span>
		<span class="last-scanned" *ngIf="buildingBlock.lastScanned" fxFlex="104px" fxFlexAlign="end">{{buildingBlock.lastScanned}}</span>
	</div>
	<div class="no-reports" *ngIf="!hasMetricReports()" fxLayout="row">
		<span fxFlex="100%">No Reports</span>
	</div>
	<div class="product-detail" *ngIf="hasMetricReports()" fxLayout="row" fxLayoutWrap>
		<div class="metric-detail" *ngFor="let metric of buildingBlock.metrics; last as isLast" fxLayout="row" fxFlex="250px" [ngClass]="{'last-metric': isLast}">
			<div *ngIf="metric.isEmpty" class="empty-metric">
				<span class="empty">No Reports</span>
				<span class="name" fxFlex="70px">{{metric.value?.name | buildingBlockMetricName}}</span>
			</div>
			<div *ngIf="!metric.isEmpty">
				<app-metric-trend-indicator *ngIf="metric.trend && metric.available" [trend]="metric.trend"></app-metric-trend-indicator>
				<span class="scored" *ngIf="metric.available">
					<span *ngIf="metric.value.prefix" class="prefix">{{metric.value?.prefix}}</span>{{metric.value?.value | number}}<span *ngIf="metric.value.unit" class="unit">{{metric.value?.unit}}</span><span *ngIf="metric.isRatio" class="percent">%</span>
				</span>
				<span class="empty-metric" *ngIf="!metric.available">
					<span class="empty">{{metric.message}}</span>
				</span>


			<span class="name" *ngIf="metric.available" fxFlex="70px">{{metric.value?.name | buildingBlockMetricName}}</span>
			</div>
		
		
		<button type="button"  [ngClass]="!isNavigationValidComponent()?'btnHidden':'btn btn-outlined ucase view-details'" *ngIf="isNavigationValidComponent()"  
			(click)="gotToBuildingBlockDetails()">Details
			<img src="../../../../../../../assets/images/right-arrow.svg" *ngIf="isComponent" />
		</button>
		</div>
	</div>
	<div class="reporting">

		<div class="poc-lob" *ngIf="buildingBlock.poc && buildingBlock.lob" fxFlex="100%" fxFlexAlign="end">
			{{buildingBlock.poc}} &mdash; {{buildingBlock.lob}}
		</div>
		<div class="poc-lob" *ngIf="!buildingBlock.poc || !buildingBlock.lob" fxFlex="100%" fxFlexAlign="end">
			{{buildingBlock.poc}}{{buildingBlock.lob}}
		</div>
	</div>
</div>

<div class="product" [ngClass]="{'selectable': hasMetricReports()}" *ngIf="isOutsideNavigationValid() == 0">
	<div class="product-heading" fxLayout="row">
    	<span class="name" fxFlex>{{buildingBlock.name}}</span>
		<span class="last-scanned" *ngIf="buildingBlock.lastScanned" fxFlex="104px" fxFlexAlign="end">{{buildingBlock.lastScanned}}</span>
	</div>
	<div class="no-reports" *ngIf="!hasMetricReports()" fxLayout="row">
		<span fxFlex="100%">No Reports</span>
	</div>
	<div class="product-detail" *ngIf="hasMetricReports()" fxLayout="row" fxLayoutWrap>
		<div class="metric-detail" *ngFor="let metric of buildingBlock.metrics; last as isLast" fxLayout="row" fxFlex="250px" [ngClass]="{'last-metric': isLast}">
			<div *ngIf="metric.isEmpty" class="empty-metric">
				<span class="empty">No Reports</span>
				<span class="name" fxFlex="70px">{{metric.value?.name | buildingBlockMetricName}}</span>
			</div>
			<div *ngIf="!metric.isEmpty">
				<app-metric-trend-indicator *ngIf="metric.trend && metric.available" [trend]="metric.trend"></app-metric-trend-indicator>
				<span class="scored" *ngIf="metric.available">
					<span *ngIf="metric.value.prefix" class="prefix">{{metric.value?.prefix}}</span>{{metric.value?.value | number}}<span *ngIf="metric.value.unit" class="unit">{{metric.value?.unit}}</span><span *ngIf="metric.isRatio" class="percent">%</span>
				</span>
				<span class="empty-metric" *ngIf="!metric.available">
					<span class="empty">{{metric.message}}</span>
				</span>
			<span class="name" *ngIf="metric.available" fxFlex="70px">{{metric.value?.name | buildingBlockMetricName}}</span>
			
			</div>
	
		<button type="button"  [ngClass]="hideDetailBtn(metric)?'btnHidden':'btn btn-outlined ucase view-details'" *ngIf="isNavigationValid()" 
			(click)="gotToBuildingBlockDetails()">Details
			<img src="../../../../../../../assets/images/right-arrow.svg" *ngIf="isComponent" />
		</button>
		</div>
	</div>
	<div class="reporting">

			<div class="completeness" *ngIf="hasMetricReports() && isDataSourceSecurity" fxFlexAlign="start">
					Critical : {{buildingBlock.metrics[0].critical}} &nbsp; High : {{buildingBlock.metrics[0].blocker}} &nbsp; Medium :{{buildingBlock.metrics[0].major}}  
			</div>

		<div class="completeness" *ngIf="!isComponent && buildingBlock.reporting > 0" fxFlexAlign="start">
			<!-- {{buildingBlock.completeness}}%
			Complete  -->
		</div>
		<div class="poc-lob" *ngIf="buildingBlock.poc && buildingBlock.lob" fxFlex="100%" fxFlexAlign="end">
			{{buildingBlock.poc}} &mdash; {{buildingBlock.lob}}
		</div>
		<div class="poc-lob" *ngIf="!buildingBlock.poc || !buildingBlock.lob" fxFlex="100%" fxFlexAlign="end">
			{{buildingBlock.poc}}{{buildingBlock.lob}}
		</div>
	</div>
</div>

<div class="product" [ngClass]="{'selectable': hasMetricReports()}" *ngIf="isOutsideNavigationValid() == 2">
	<div class="product-heading" fxLayout="row">
    	<span class="name" fxFlex>{{buildingBlock.name}}</span>
		<span class="last-scanned" *ngIf="buildingBlock.lastScanned" fxFlex="104px" fxFlexAlign="end">{{buildingBlock.lastScanned}}</span>
	</div>
	<div class="no-reports" *ngIf="!hasMetricReports()" fxLayout="row">
		<span fxFlex="100%">No Reports</span>
	</div>
	<div class="product-detail" *ngIf="hasMetricReports()" fxLayout="row" fxLayoutWrap>
		<div class="metric-detail" *ngFor="let metric of buildingBlock.metrics; last as isLast" [hidden]="showMetrics(metric.name)" fxLayout="row" fxFlex="140px" [ngClass]="{'last-metric': isLast}">
			<div *ngIf="metric.isEmpty" class="empty-metric">
				<span class="empty">No Reports</span>
				<span class="name" fxFlex="110px">{{metric.value?.name | buildingBlockMetricName}}</span>
			</div>
			<div *ngIf="!metric.isEmpty">
				<app-metric-trend-indicator *ngIf="metric.trend && metric.available" [trend]="metric.trend"></app-metric-trend-indicator>
				<span class="score" *ngIf="metric.available">
					<span *ngIf="metric.value.prefix" class="prefix">{{metric.value?.prefix}}</span>{{metric.value?.value | number}}<span *ngIf="metric.value.unit" class="unit">{{metric.value?.unit}}</span><span *ngIf="metric.isRatio" class="percent">%</span>
				</span>
				<span class="empty-metric" *ngIf="!metric.available">
					<span class="empty">{{metric.message}}</span>
				</span>
			<span class="name" *ngIf="metric.available" fxFlex="110px">{{metric.value?.name | buildingBlockMetricName}}</span>
			</div>
		
		<button type="button"  [ngClass]="(!metric.isEmpty && !metric.available)?'btnHidden':'btn btn-outlined ucase view-details'" *ngIf="isNavigationValid()"    
			(click)="gotToBuildingBlockDetails()">Details
			<img src="../../../../../../../assets/images/right-arrow.svg" *ngIf="isComponent" />
		</button>
		</div>
	</div>
	<div class="reporting">
		<div class="completeness" *ngIf="!isComponent && buildingBlock.reporting > 0" fxFlexAlign="start">
			<!-- {{buildingBlock.completeness}}%
			Complete  -->
		</div>
		<div class="poc-lob" *ngIf="buildingBlock.poc && buildingBlock.lob" fxFlex="100%" fxFlexAlign="end">
			{{buildingBlock.poc}} &mdash; {{buildingBlock.lob}}
		</div>
		<div class="poc-lob" *ngIf="!buildingBlock.poc || !buildingBlock.lob" fxFlex="100%" fxFlexAlign="end">
			{{buildingBlock.poc}}{{buildingBlock.lob}}
		</div>
	</div>
</div>
